{% extends "base.html" %}

{% block title %}Class Schedule - Gym Manager{% endblock %}

{% block content %}
<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
    <h1
        style="font-size: 2.5rem; background: linear-gradient(135deg, var(--primary), var(--secondary)); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent;">
        Weekly Schedule
    </h1>
    <button onclick="document.getElementById('addClassModal').style.display='block'" class="btn">
        + Add Class
    </button>
</div>

<!-- Class List -->
<div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1.5rem;">
    {% for cls in classes %}
    <div class="card" style="position: relative; overflow: hidden;">
        <div
            style="background: var(--primary); color: white; padding: 0.5rem 1rem; position: absolute; top: 0; right: 0; border-bottom-left-radius: 12px; font-size: 0.8rem; font-weight: bold;">
            {{ cls.day }}
        </div>

        <h2 style="margin-bottom: 0.5rem;">{{ cls.name }}</h2>
        <div style="color: var(--text-muted); margin-bottom: 1rem;">
            <div>ðŸ•’ {{ cls.time }}</div>
            <div>ðŸ‘¤ {{ cls.instructor }}</div>
            <div>ðŸ‘¥ {{ cls.attendees|length }} / {{ cls.capacity }} filled</div>
        </div>

        <!-- Booking Form -->
        <form action="{{ url_for('book_class', class_id=cls.id) }}" method="POST" style="display: flex; gap: 0.5rem;">
            <select name="member_id" required
                style="padding: 0.5rem; border-radius: 6px; border: 1px solid var(--border); background: hsla(0,0%,100%,0.1); color: var(--text); width: 100%;">
                <option value="">Select Member</option>
                {% for m in members %}
                <option value="{{ m.id }}">{{ m.name }}</option>
                {% endfor %}
            </select>
            <button type="submit" class="btn btn-success" style="padding: 0.5rem 1rem;">Book</button>
        </form>
    </div>
    {% else %}
    <p style="grid-column: 1/-1; text-align: center; color: var(--text-muted);">No classes scheduled yet.</p>
    {% endfor %}
</div>

<!-- Add Class Modal -->
<div id="addClassModal"
    style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000;">
    <div class="card" style="max-width: 500px; margin: 10% auto; position: relative;">
        <button onclick="document.getElementById('addClassModal').style.display='none'"
            style="position: absolute; top: 1rem; right: 1rem; background: none; border: none; color: var(--text); font-size: 1.5rem; cursor: pointer;">&times;</button>

        <h2 style="margin-bottom: 1.5rem;">Add New Class</h2>

        <form method="POST">
            <div class="form-group">
                <label>Class Name</label>
                <input type="text" name="name" required placeholder="e.g. Morning Yoga">
            </div>

            <div class="form-group">
                <label>Day</label>
                <select name="day" required>
                    <option value="Monday">Monday</option>
                    <option value="Tuesday">Tuesday</option>
                    <option value="Wednesday">Wednesday</option>
                    <option value="Thursday">Thursday</option>
                    <option value="Friday">Friday</option>
                    <option value="Saturday">Saturday</option>
                    <option value="Sunday">Sunday</option>
                </select>
            </div>

            <div class="form-group">
                <label>Time</label>
                <input type="time" name="time" required>
            </div>

            <div class="form-group">
                <label>Instructor</label>
                <input type="text" name="instructor" required placeholder="e.g. John Doe">
            </div>

            <div class="form-group">
                <label>Capacity</label>
                <input type="number" name="capacity" required value="20">
            </div>

            <button type="submit" class="btn" style="width: 100%;">Create Class</button>
        </form>
    </div>
</div>
{% endblock %}