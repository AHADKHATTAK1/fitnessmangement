{% extends "base.html" %}

{% block title %}ðŸ’° Payment Center - Premium{% endblock %}

{% block content %}
<style>
    @media (max-width: 768px) {
        .payment-container {
            padding: 80px 16px 16px 16px;
        }
    }

    .payment-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 40px 20px;
    }

    .payment-header {
        background: linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%);
        padding: 40px;
        border-radius: 24px;
        color: white;
        margin-bottom: 40px;
        box-shadow: 0 20px 60px rgba(139, 92, 246, 0.3);
    }

    .payment-header h1 {
        font-size: 36px;
        margin: 0 0 10px 0;
        font-weight: 800;
    }

    .payment-header p {
        font-size: 18px;
        opacity: 0.95;
        margin: 0;
    }

    .payment-tabs {
        display: flex;
        gap: 16px;
        margin-bottom: 32px;
        flex-wrap: wrap;
    }

    .payment-tab {
        flex: 1;
        min-width: 200px;
        padding: 20px;
        background: white;
        border-radius: 16px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        cursor: pointer;
        transition: all 0.3s ease;
        border: 2px solid transparent;
    }

    .payment-tab.active {
        border-color: #8b5cf6;
        background: linear-gradient(135deg, #f3e8ff 0%, #fdf4ff 100%);
        box-shadow: 0 8px 24px rgba(139, 92, 246, 0.2);
    }

    .payment-tab:hover {
        transform: translateY(-4px);
        box-shadow: 0 12px 32px rgba(0, 0, 0, 0.12);
    }

    .payment-form-card {
        background: white;
        padding: 40px;
        border-radius: 24px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
        margin-bottom: 32px;
    }

    .form-group {
        margin-bottom: 24px;
    }

    .form-group label {
        display: block;
        font-weight: 600;
        margin-bottom: 8px;
        color: #1f2937;
        font-size: 15px;
    }

    .form-input {
        width: 100%;
        padding: 16px;
        border: 2px solid #e5e7eb;
        border-radius: 12px;
        font-size: 16px;
        transition: all 0.3s ease;
        background: #f9fafb;
    }

    .form-input:focus {
        outline: none;
        border-color: #8b5cf6;
        background: white;
        box-shadow: 0 0 0 4px rgba(139, 92, 246, 0.1);
    }

    .payment-history-table {
        background: white;
        border-radius: 24px;
        overflow: hidden;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
    }

    .table-header {
        background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
        color: white;
        padding: 20px;
        font-weight: 600;
    }

    .table-row {
        padding: 20px;
        border-bottom: 1px solid #f3f4f6;
        transition: all 0.2s ease;
    }

    .table-row:hover {
        background: #f9fafb;
    }

    .status-badge {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 6px 14px;
        border-radius: 20px;
        font-size: 13px;
        font-weight: 600;
    }

    .status-paid {
        background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        color: white;
    }

    .status-pending {
        background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        color: white;
    }

    .empty-state {
        text-align: center;
        padding: 80px 20px;
        color: #9ca3af;
    }

    .empty-state-icon {
        font-size: 64px;
        margin-bottom: 20px;
    }
</style>

<div class="payment-container">
    <!-- Premium Header -->
    <div class="payment-header">
        <h1>ðŸ’° Payment Center</h1>
        <p>Record payments & manage transaction history</p>
    </div>

    <!-- Tabs -->
    <div class="payment-tabs">
        <div class="payment-tab active" onclick="showTab('record')">
            <div style="font-size: 28px; margin-bottom: 8px;">ðŸ’³</div>
            <div style="font-weight: 600; font-size: 16px;">Record Payment</div>
            <div style="font-size: 13px; color: #6b7280; margin-top: 4px;">Add new transaction</div>
        </div>
        <div class="payment-tab" onclick="showTab('history')">
            <div style="font-size: 28px; margin-bottom: 8px;">ðŸ“œ</div>
            <div style="font-weight: 600; font-size: 16px;">Payment History</div>
            <div style="font-size: 13px; color: #6b7280; margin-top: 4px;">View all transactions</div>
        </div>
    </div>

    <!-- Record Payment Form -->
    <div id="record-tab" class="tab-content">
        <div class="payment-form-card">
            <h2 style="margin-bottom: 24px; display: flex; align-items: center; gap: 12px;">
                <span style="font-size: 32px;">ðŸ’³</span>
                Record New Payment
            </h2>

            <form action="{{ url_for('record_fee') }}" method="POST">
                <div class="form-group">
                    <label for="member_id">
                        <span style="color: #ef4444;">*</span> Select Member
                    </label>
                    <select name="member_id" id="member_id" class="form-input" required>
                        <option value="">Choose a member...</option>
                        {% for member in members %}
                        <option value="{{ member.id }}">
                            {{ member.name }} - {{ member.phone }}
                        </option>
                        {% endfor %}
                    </select>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label for="amount">
                            <span style="color: #ef4444;">*</span> Amount (Rs)
                        </label>
                        <input type="number" name="amount" id="amount" class="form-input" placeholder="e.g., 3000"
                            required min="1">
                    </div>

                    <div class="form-group">
                        <label for="month">
                            <span style="color: #ef4444;">*</span> Month
                        </label>
                        <input type="month" name="month" id="month" class="form-input" required>
                    </div>
                </div>

                <div class="form-group">
                    <label for="payment_method">Payment Method</label>
                    <select name="payment_method" id="payment_method" class="form-input">
                        <option value="cash">ðŸ’µ Cash</option>
                        <option value="online">ðŸ’³ Online Transfer</option>
                        <option value="jazzcash">ðŸ“± JazzCash</option>
                        <option value="easypaisa">ðŸ“± EasyPaisa</option>
                        <option value="card">ðŸ’³ Debit/Credit Card</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="notes">Notes (Optional)</label>
                    <textarea name="notes" id="notes" class="form-input" rows="3"
                        placeholder="Add any additional notes..."></textarea>
                </div>

                <button type="submit" class="btn-primary" style="width: 100%; margin-top: 20px;">
                    <span style="font-size: 20px; margin-right: 8px;">âœ“</span>
                    Record Payment
                </button>
            </form>
        </div>
    </div>

    <!-- Payment History -->
    <div id="history-tab" class="tab-content" style="display: none;">
        <div class="payment-history-table">
            <div class="table-header">
                <h3 style="margin: 0; font-size: 20px;">Payment History</h3>
            </div>

            {% if fees %}
            <div style="padding: 20px;">
                {% for fee in fees %}
                <div class="table-row"
                    style="display: grid; grid-template-columns: 2fr 1fr 1fr 1fr 1fr; gap: 16px; align-items: center;">
                    <div>
                        <div style="font-weight: 600; color: #1f2937; margin-bottom: 4px;">
                            {{ fee.member.name }}
                        </div>
                        <div style="font-size: 13px; color: #6b7280;">
                            {{ fee.member.phone }}
                        </div>
                    </div>
                    <div style="font-weight: 600; color: #059669; font-size: 18px;">
                        Rs {{ fee.amount }}
                    </div>
                    <div style="color: #6b7280;">
                        {{ fee.month }}
                    </div>
                    <div>
                        <span class="status-badge status-paid">
                            âœ“ Paid
                        </span>
                    </div>
                    <div style="font-size: 13px; color: #9ca3af;">
                        {{ fee.paid_date.strftime('%d %b %Y') }}
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div class="empty-state">
                <div class="empty-state-icon">ðŸ“­</div>
                <h3 style="color: #6b7280; margin-bottom: 8px;">No Payments Yet</h3>
                <p style="color: #9ca3af;">Record your first payment to see it here!</p>
            </div>
            {% endif %}
        </div>
    </div>
</div>

<script>
    function showTab(tabName) {
        // Hide all tabs
        document.querySelectorAll('.tab-content').forEach(tab => {
            tab.style.display = 'none';
        });

        // Remove active class from all tabs
        document.querySelectorAll('.payment-tab').forEach(tab => {
            tab.classList.remove('active');
        });

        // Show selected tab
        if (tabName === 'record') {
            document.getElementById('record-tab').style.display = 'block';
            document.querySelectorAll('.payment-tab')[0].classList.add('active');
        } else {
            document.getElementById('history-tab').style.display = 'block';
            document.querySelectorAll('.payment-tab')[1].classList.add('active');
        }
    }

    // Set current month as default
    document.addEventListener('DOMContentLoaded', function () {
        const monthInput = document.getElementById('month');
        const now = new Date();
        const year = now.getFullYear();
        const month = String(now.getMonth() + 1).padStart(2, '0');
        monthInput.value = `${year}-${month}`;
    });
</script>

{% endblock %}